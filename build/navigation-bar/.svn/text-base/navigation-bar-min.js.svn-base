(function(){function A(B){B=B||{};if(B.navigationController){this.navigationController=B.navigationController;}if(B.tintColor){this.tintColor=B.tintColor;}this.initialize();}A.prototype={element:null,itemsContainer:null,items:null,tintColor:null,handleEvent:function(C){var B=mui.getAncestorByClassName(C.target,"mui-navback");switch(C.type){case"touchstart":case"mousedown":C.preventDefault();if(B){mui.addClass(this._backElement,"mui-depressed");}break;case"touchmove":case"mousemove":if(B){mui.removeClass(this._backElement,"mui-depressed");}break;case"touchend":case"mouseup":C.preventDefault();if(B){setTimeout(mui.removeClass,0,this._backElement,"mui-depressed");}break;case"click":if(mui.getAncestorByClassName(C.target,"mui-navtitle")){if(this.navigationController){this.navigationController.didClickTitle();}}break;}},setItems:function(B,D,C){this.show();this.setLeftBarItem(B.leftBarItem);if(!B.leftBarItem){this.setBack(B.back,B.backAction);}else{this.setBack(null);}this.setRightBarItem(B.rightBarItem);this.setTitle(B.title);},setItemsWithAnimation:function(B,C){var D=this.itemsContainer.cloneNode(true);mui.addClass(D,"mui-navbar-clone");mui.insertBefore(D,this.itemsContainer);this.setLeftBarItem(B.leftBarItem);if(!B.leftBarItem){this.setBack(B.back,B.backAction);}this.setRightBarItem(B.rightBarItem);this.setTitle(B.title);this.itemsContainer.style.visibility="hidden";this.itemsContainer.style.webkitTransitionDuration="0s";this.itemsContainer.style.webkitTransform=C?"translateX(-50%)":"translateX(50%)";this.itemsContainer.style.opacity="0";setTimeout(mui.bind(function(){this.itemsContainer.style.visibility="visible";this.itemsContainer.style.webkitTransitionDuration="";this.itemsContainer.style.opacity="1";this.itemsContainer.style.webkitTransform="translateX(0)";D.style.opacity="0";D.style.webkitTransform=C?"translateX(50%)":"translateX(-50%)";setTimeout(function(){D.parentNode.removeChild(D);},300);},this),1);},setBack:function(C,F,E){var D=E||this._backElement,B;if(!C){mui.addClass(D,"mui-hidden");D.innerHTML="";mui.removeEventListener(D,"touchend");mui.removeEventListener(D,"click");}else{mui.removeEventListener(D,"click");mui.removeClass(D,"mui-hidden");if(typeof C==="string"){mui.removeClass(D,"mui-backicon");B=(typeof F==="string")?'<h6 class="mui-navbar-back"><a href="'+F+'">'+C+"</a></h6>":'<h6 class="mui-navbar-back">'+C+"</h6>";}else{mui.addClass(D,"mui-backicon");B=(typeof F==="string")?'<h6 class="mui-navbar-back"><a href="'+F+'"><b></b></a></h6>':'<h6 class="mui-navbar-back"><b class="mui-navbar-b"></b></h6>';}D.innerHTML=B;if(typeof F==="function"){mui.one(D,"click",F);}mui.on(D,"touchstart",this);mui.on(D,"touchmove",this);mui.on(D,"touchend",this);}return D;},setLeftBarItem:function(B){this._leftBarItemElement.innerHTML="";if(B instanceof HTMLElement){mui.addClass(B,"mui-nav-child");this._leftBarItemElement.appendChild(B);}else{if(mui.Button&&B instanceof mui.Button){B.render(this._leftBarItemElement);}else{this._leftBarItemElement.innerHTML="";}}},setRightBarItem:function(B){this._rightBarItemElement.innerHTML="";if(mui.Pager&&B instanceof mui.Pager){B.render(this._rightBarItemElement);}else{if(mui.Button&&B instanceof mui.Button){B.render(this._rightBarItemElement);}else{if(B instanceof HTMLElement){mui.addClass(B,"mui-nav-child");this._rightBarItemElement.appendChild(B);}else{this._rightBarItemElement.innerHTML="";}}}},setTitle:function(J,E){var C=E||this._titleElement,B=mui.createElement("div",{className:"mui-navtitle-el"}),D,M,K,H,P,I,F,L=this.element.offsetWidth-30,G=this._backElement?this._backElement.offsetWidth:0,O=this._rightBarItemElement?this._rightBarItemElement.offsetWidth:0,N=this._leftBarItemElement?this._leftBarItemElement.offsetWidth:0;this.title=J;C.innerHTML="";mui.addClass(C,"mui-noleft");C.appendChild(B);if(mui.SearchBox&&J instanceof mui.SearchBox){mui.addClass(B,"mui-block");if(!G){mui.addClass(B,"mui-wide");}J.render(B);}else{if(typeof J==="string"){B.appendChild(document.createTextNode(J));}else{if(J){B.appendChild(J);}}}if(G&&B){mui.removeClass(C,"mui-noleft");D=G;L-=D;}if(O&&B){M=O;L-=M;}if(N&&B){mui.removeClass(C,"mui-noleft");D=N;L-=D;}mui.setStyle(B,"max-width",L+"px");I=B.offsetWidth;F=B.offsetLeft;if(G&&B){B.style.marginLeft="-"+G+"px";if(F<=(C.offsetLeft+3)){B.style.marginLeft="";mui.addClass(B,"mui-block");}}if(O&&B){B.style.marginRight="-"+O+"px";P=mui.getXY(this._rightBarItemElement);if((F+I)>=P[0]){B.style.marginRight="";mui.addClass(B,"mui-block");}}if(N&&B){B.style.marginLeft="-"+N+"px";if(F<=D){B.style.marginLeft="";mui.addClass(B,"mui-block");}}return C;},hide:function(){this.element.removeAttribute("x-mui-showing");},show:function(){this.element.setAttribute("x-mui-showing","true");},setTintColor:function(B){this.tintColor=B;if(typeof this.tintColor==="string"){mui.addClass(this.element,"mui-tinted");this.element.style.background=this.tintColor;}else{mui.removeClass(this.element,"mui-tinted");this.element.style.background="";}},initialize:function(){var B=mui.get("body > header");this.element=mui.createElement("div",{className:"mui-navbar"});if(this.navigationController){this.element.setAttribute("x-mui-controller",this.navigationController.NAME);}this.itemsContainer=mui.createElement("div",{className:"mui-navbar-wrap"});this.element.appendChild(this.itemsContainer);if(!B){B=mui.createElement("header");mui.insertBefore(B,document.body.firstChild);}if(B.lastChild){mui.insertAfter(this.element,B.lastChild);}else{B.appendChild(this.element);}this.items={back:null,leftBarItem:null,title:null,rightBarItem:null};this._backElement=mui.createElement("div",{className:"mui-navbar-el mui-navback"});this._leftBarItemElement=mui.createElement("div",{className:"mui-navbar-el mui-navleft"});this._titleElement=mui.createElement("div",{className:"mui-navbar-el mui-navtitle"});this._rightBarItemElement=mui.createElement("div",{className:"mui-navbar-el mui-navright"});this.itemsContainer.appendChild(this._backElement);this.itemsContainer.appendChild(this._leftBarItemElement);
this.itemsContainer.appendChild(this._titleElement);this.itemsContainer.appendChild(this._rightBarItemElement);if(this.tintColor){this.setTintColor(this.tintColor);}mui.on(this.element,"click",this);mui.on(window,"orientationchange",mui.bind(function(){if(this.title){this.setTitle(this.title);}},this));}};mui.NavigationBar=A;})();