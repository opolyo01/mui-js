(function(){function A(D,B,C){if(typeof D!=="object"){throw new Error("Transition: inView parameter must be an HTMLElement");}if(typeof B!=="object"){throw new Error("Transition: outView parameter must be an HTMLElement");}this.inView=D;this.outView=B;this.options=C||{};this.backupTimer=null;this._setup();}A.TYPE_PUSH="push";A.TYPE_SLIDE="slide";A.TYPE_FADE="fade";A.TYPE_FLIP="flip";A.DIR_RIGHT_TO_LEFT="right-to-left";A.DIR_LEFT_TO_RIGHT="left-to-right";A.DIR_TOP_TO_BOTTOM="top-to-bottom";A.DIR_BOTTOM_TO_TOP="bottom-to-top";A.DURATIONS={push:350,fade:800,slide:400,flip:650};A.prototype._setTransitionProperties=function(C){var B=this.inView.style,D=this.outView.style;B.webkitTransitionProperty=D.webkitTransitionProperty=C.join(" ");B.webkitTransitionTimingFunction=D.webkitTransitionTimingFunction=this.options.timing;B.webkitTransitionDuration=D.webkitTransitionDuration=this.options.duration+"ms";};A.prototype._removeTransitionProperties=function(){var B=this.inView.style,C=this.outView.style;this.inView.removeEventListener("webkitTransitionEnd",this._transitionEnd,false);this.outView.removeEventListener("webkitTransitionEnd",this._transitionEnd,false);B.display="";C.display="";B.webkitTransitionProperty=C.webkitTransitionProperty="";B.webkitTransitionTimingFunction=C.webkitTransitionTimingFunction="";B.webkitTransitionDuration=C.webkitTransitionDuration="";C.webkitBackfaceVisibility="";C.webkitTransform="";C.removeProperty("opacity");B.removeProperty("opacity");};A.prototype._transitionEnd=function(){if(this.backupTimer){clearTimeout(this.backupTimer);this.backupTimer=null;}else{return;}if(this.options.onComplete){this.options.onComplete();}this._removeTransitionProperties();if(this.options.fullscreen){this.inView.style.width="";}};A.prototype._translate=function(D,C,H,G,E,B){var F=mui.UA.Apple?"translate3d("+(C||0)+", "+(H||0)+", "+(G||0)+")":"translate("+(C||0)+", "+(H||0)+")";if(E){D.style.webkitTransitionTimingFunction="ease-in-out";D.style.webkitTransitionProperty="-webkit-transform";D.style.webkitTransitionDuration=E+"ms";mui.one(D,"webkitTransitionEnd",function(){D.style.webkitTransitionTimingFunction="";D.style.webkitTransitionTimingProperty="";D.style.webkitTransitionDuration="";if(typeof B==="function"){B();}});}D.style.webkitTransform=F;return D;};A.prototype._setup=function(){var B=this.inView.parentNode;this._offsetWidth=this.outView.offsetWidth;if(B){this.inView.parentNode.style.position="relative";}this.options.type=this.options.type||A.TYPE_PUSH;this.options.duration=(typeof this.options.duration!="undefined")?this.options.duration:A.DURATIONS[this.options.type];if(this.options.type===A.TYPE_SLIDE){this.options.direction=this.options.direction||A.DIR_LEFT_TO_RIGHT;}if(typeof this.options.fullscreen=="undefined"){this.options.fullscreen=true;}if(!(this.inView instanceof HTMLBodyElement)){this.inView.style.position="absolute";this.inView.style.width=this.options.fullscreen?"100%":this._offsetWidth+"px";this.inView.style.left="0";this.inView.style.top="0";this.inView.style.display="block";}switch(this.options.type){case A.TYPE_FLIP:this.options.timing="linear";this.inView.parentNode.style.webkitPerspective="500px";this.inView.parentNode.style.webkitTransformStyle="preserve-3d";this.inView.style.display="none";this.inView.style.webkitBackfaceVisibility=this.outView.style.webkitBackfaceVisibility="hidden";this.inView.style.webkitTransform=this.options.reverse?"rotateY(180deg)":"rotateY(-180deg)";this.inView.style.display="block";this.outView.style.webkitTransform="rotateY(0)";this.outView.style.display="block";setTimeout(mui.bind(function(){this._setTransitionProperties(["-webkit-transform"]);},this),0);break;case A.TYPE_SLIDE:scrollTo(0,0);this.options.timing="ease-in-out";switch(this.options.direction){case A.DIR_BOTTOM_TO_TOP:this._translate(this.options.reverse?this.outView:this.inView,0,(this.options.reverse?0:window.innerHeight)+"px",0);break;case A.DIR_TOP_TO_BOTTOM:this._translate(this.options.reverse?this.outView:this.inView,0,(this.options.reverse?0:-window.innerHeight)+"px",0);break;case A.DIR_RIGHT_TO_LEFT:this._translate(this.options.reverse?this.outView:this.inView,(this.options.reverse?0:window.innerWidth)+"px",0,0);break;case A.DIR_LEFT_TO_RIGHT:default:this._translate(this.options.reverse?this.outView:this.inView,(this.options.reverse?0:-window.innerWidth)+"px",0,0);}break;case A.TYPE_FADE:this.options.timing="linear";if(this.options.reverse){this.inView.style.opacity="1";this.outView.style.opacity="1";}else{this.inView.style.opacity="0";}setTimeout(mui.bind(function(){this._setTransitionProperties(["opacity"]);},this),0);break;case A.TYPE_PUSH:default:this.options.timing="ease-in-out";this._translate(this.inView,(this.options.reverse?-this._offsetWidth:this._offsetWidth)+"px",0,0);}};A.prototype.execute=function(){switch(this.options.type){case A.TYPE_SLIDE:setTimeout(mui.bind(function(){var B=[0,0];switch(this.options.direction){case A.DIR_BOTTOM_TO_TOP:B=this.options.reverse?[0,window.innerHeight]:[0,0];break;case A.DIR_TOP_TO_BOTTOM:B=this.options.reverse?[0,-window.innerHeight]:[0,0];break;case A.DIR_RIGHT_TO_LEFT:B=this.options.reverse?[window.innerWidth,0]:[0,0];break;case A.DIR_LEFT_TO_RIGHT:default:B=this.options.reverse?[-window.innerWidth,0]:[0,0];break;}this._translate(this.options.reverse?this.outView:this.inView,B[0]+"px",B[1]+"px",0,this.options.duration,mui.bind(this._transitionEnd,this));},this),0);break;case A.TYPE_FLIP:setTimeout(mui.bind(function(){mui.one(this.inView,"webkitTransitionEnd",mui.bind(this._transitionEnd,this));this.outView.style.webkitTransform=this.options.reverse?"rotateY(-180deg)":"rotateY(180deg)";this.inView.style.webkitTransform="rotateY(0deg)";},this),0);break;case A.TYPE_FADE:setTimeout(mui.bind(function(){mui.one(this.inView,"webkitTransitionEnd",mui.bind(this._transitionEnd,this));if(this.options.reverse){this.outView.style.opacity="0";}else{this.inView.style.opacity="1";}},this),1);break;case A.TYPE_PUSH:default:this._translate(this.outView,(this.options.reverse?this._offsetWidth:-this._offsetWidth)+"px",0,0,this.options.duration);
this._translate(this.inView,0,0,0,this.options.duration,mui.bind(this._transitionEnd,this));}this.backupTimer=setTimeout(mui.bind(this._transitionEnd,this),(this.options.duration+50));};mui.Transition=A;})();