<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: loader   Loader.js  (mui Library)</title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1259613749.47" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1259613749.47" />

    <script type="text/javascript" src="assets/api-js?stamp=1259613749.47"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1259613749.47"></script>
	<script type="text/javascript" charset="utf-8">
		window.addEventListener('load', function() {
			document.getElementById('doc3').style.minHeight = window.innerHeight+'px'
		}, false);
	</script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	
	<div id="hd">
		<div class="primary">
			<h1><a href="" title="mui">mui</a></h1>

			<span class="description">Mobile User Interface <strong>v1.0.0</strong></span>
	
	       		<form onsubmit="return false">
	       			<div id="propertysearch">
					<span class="focus"></span>
					<input autocomplete="off" id="searchinput" placeholder="Search" />
	                		<div id="searchresults">
	                    			&nbsp;
	                		</div>
	            		</div>
	        	</form>
		</div>
		<div class="secondary">
			
			<div class="nav">
				<a href="./index.html" title="mui">mui</a>
	            		<span class="gt"></span> <a href="./module_loader.html" title="loader">loader</a>
	               		
	               		 <span class="gt"></span> Loader.js (source view) 
			</div>

			<div class="meta">
		            	<form action="#" name="yui-classopts-form" method="get" id="yui-classopts-form">
		                	<fieldset>
		                    	<legend>Filters</legend>
		                	<span class="classopts"><input type="checkbox" name="show_private" id="show_private" /> <label for="show_private">Show Private</label></span>
		                	<span class="classopts"><input type="checkbox" name="show_protected" id="show_protected" /> <label for="show_protected">Show Protected</label></span>
		                	<span class="classopts"><input type="checkbox" name="show_deprecated" id="show_deprecated" /> <label for="show_deprecated">Show Deprecated</label></span>
		                	</fieldset>
		            	</form>
				<span class="subtitle">1.0.0</span>			
			</div>
	
			<div class="navdec"><b></b><b></b></div>
		</div>
	</div>

	<div id="bd">
		<div id="yui-main">
			<div id="doc-content" class="yui-b">

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight" ><pre><span class="c">/**</span>
<span class="c"> * Loader module</span>
<span class="c"> * @module loader</span>
<span class="c"> */</span>
<span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>

<span class="c">/**</span>
<span class="c"> * The Loader utility allows for on-demand loading of library components</span>
<span class="c"> * @class Loader</span>
<span class="c"> */</span>

<span class="c">/*</span>
<span class="c"> * Loader config</span>
<span class="c"> */</span>
<span class="c">// @TODO: this will be CDN</span>
<span class="c"></span><span class="k">var</span> <span class="nx">_base</span> <span class="o">=</span> <span class="s1">&#39;/mui/build/&#39;</span><span class="o">,</span>
    <span class="nx">_debug</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
    <span class="nx">_devMode</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span>
    <span class="nx">_syncStack</span> <span class="o">=</span> <span class="o">[],</span>
    <span class="nx">_asyncStack</span> <span class="o">=</span> <span class="o">[],</span>
    <span class="nx">_registeredModules</span> <span class="o">=</span> <span class="o">{},</span>
    <span class="nx">_syncLoaded</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
    <span class="nx">_asyncLoaded</span> <span class="o">=</span> <span class="m">0</span><span class="o">,</span>
    <span class="nx">_callback</span> <span class="o">=</span> <span class="kc">null</span><span class="o">,</span>
    <span class="nx">_callbackCtx</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="c">/*</span>
<span class="c"> * mui module definitions</span>
<span class="c"> */</span>
<span class="k">var</span> <span class="nx">MUI</span> 		<span class="o">=</span> <span class="s1">&#39;mui&#39;</span><span class="o">,</span>
    <span class="nx">ACTION_SHEET</span> 	<span class="o">=</span> <span class="s1">&#39;action-sheet&#39;</span><span class="o">,</span>
    <span class="nx">GEO</span> 		<span class="o">=</span> <span class="s1">&#39;geo&#39;</span><span class="o">,</span>
    <span class="nx">NAVIGATION_BAR</span>	<span class="o">=</span> <span class="s1">&#39;navigation-bar&#39;</span><span class="o">,</span>
    <span class="nx">NAVIGATOR</span> 		<span class="o">=</span> <span class="s1">&#39;navigator&#39;</span><span class="o">,</span>
    <span class="nx">PAGER</span> 		<span class="o">=</span> <span class="s1">&#39;pager&#39;</span><span class="o">,</span>
    <span class="nx">SCROLL_VIEW</span> 	<span class="o">=</span> <span class="s1">&#39;scroll-view&#39;</span><span class="o">,</span>
    <span class="nx">SEARCH_BOX</span> 		<span class="o">=</span> <span class="s1">&#39;search-box&#39;</span><span class="o">,</span>
    <span class="nx">STORAGE</span> 		<span class="o">=</span> <span class="s1">&#39;storage&#39;</span><span class="o">,</span>
    <span class="nx">SWIPE_VIEW</span> 		<span class="o">=</span> <span class="s1">&#39;swipe-view&#39;</span><span class="o">,</span>
    <span class="nx">TAB_VIEW</span>		<span class="o">=</span> <span class="s1">&#39;tab-view&#39;</span><span class="o">,</span>
    <span class="nx">TRANSITION</span> 		<span class="o">=</span> <span class="s1">&#39;transition&#39;</span><span class="o">,</span>
    <span class="nx">WEB_APP</span> 		<span class="o">=</span> <span class="s1">&#39;web-app&#39;</span><span class="o">,</span>
	
    <span class="nx">_modules</span>		<span class="o">=</span> <span class="o">{};</span>

<span class="nx">_modules</span><span class="o">[</span><span class="s1">&#39;mui&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;mui.js&#39;</span><span class="o">,</span>
	<span class="nx">css</span><span class="o">:</span> <span class="s1">&#39;reset.css&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">ACTION_SHEET</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;ActionSheet.js&#39;</span><span class="o">,</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">]</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">GEO</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;Geo.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">NAVIGATION_BAR</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;NavigationBar.js&#39;</span><span class="o">,</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">]</span>
<span class="o">},</span>	
<span class="nx">_modules</span><span class="o">[</span><span class="nx">NAVIGATOR</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;Navigator.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">PAGER</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;Pager.js&#39;</span><span class="o">,</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">]</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">SCROLL_VIEW</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;ScrollView.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">SEARCH_BOX</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;SearchBox.js&#39;</span><span class="o">,</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">]</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">STORAGE</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;Storage.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">SWIPE_VIEW</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;SwipeView.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">TAB_VIEW</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;TabView.js&#39;</span><span class="o">,</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">]</span>
<span class="o">},</span>	
<span class="nx">_modules</span><span class="o">[</span><span class="nx">TRANSITION</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;Transition.js&#39;</span>
<span class="o">},</span>
<span class="nx">_modules</span><span class="o">[</span><span class="nx">WEB_APP</span><span class="o">]</span> <span class="o">=</span> <span class="o">{</span>
	<span class="nx">skins</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;default&#39;</span><span class="o">],</span>
	<span class="nx">required</span><span class="o">:</span> <span class="o">[</span>
		<span class="s1">&#39;storage&#39;</span><span class="o">,</span> <span class="s1">&#39;navigator&#39;</span><span class="o">,</span> <span class="s1">&#39;navigation-bar&#39;</span>
	<span class="o">],</span>
	<span class="nx">submodules</span><span class="o">:</span> <span class="o">{</span>			
		<span class="s1">&#39;application-controller&#39;</span><span class="o">:</span> <span class="o">{</span>
			<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;ApplicationController.js&#39;</span>
		<span class="o">},</span>
		<span class="s1">&#39;navigation-controller&#39;</span><span class="o">:</span> <span class="o">{</span>
			<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;NavigationController.js&#39;</span>				
		<span class="o">},</span>
		<span class="s1">&#39;view-controller&#39;</span><span class="o">:</span> <span class="o">{</span>
			<span class="nx">js</span><span class="o">:</span> <span class="s1">&#39;ViewController.js&#39;</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">};</span>

<span class="c">/**</span>
<span class="c"> * Insert a &lt;script&gt; into the document</span>
<span class="c"> * @method insertScript</span>
<span class="c"> * @param src {String} The script src</span>
<span class="c"> * @param cb {Function} (Optional) Callback invoked on script load</span>
<span class="c"> * @private</span>
<span class="c"> */</span>
<span class="k">function</span> <span class="nx">insertScript</span><span class="o">(</span><span class="nx">src</span><span class="o">,</span> <span class="nx">cb</span><span class="o">)</span> 
<span class="o">{</span>
	<span class="k">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">&#39;script&#39;</span><span class="o">);</span>
	<span class="nx">script</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="o">;</span>
	<span class="nx">script</span><span class="o">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">src</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="nx">cb</span><span class="o">)</span> <span class="nx">script</span><span class="o">.</span><span class="nx">addEventListener</span><span class="o">(</span><span class="s1">&#39;load&#39;</span><span class="o">,</span> <span class="nx">cb</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
	<span class="nb">document</span><span class="o">.</span><span class="nx">getElementsByTagName</span><span class="o">(</span><span class="s1">&#39;head&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">].</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">script</span><span class="o">);</span>
<span class="o">}</span>

<span class="k">function</span> <span class="nx">insertStylesheet</span><span class="o">(</span><span class="nx">src</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="o">.</span><span class="nx">createElement</span><span class="o">(</span><span class="s1">&#39;link&#39;</span><span class="o">);</span>
	<span class="nx">link</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">&#39;rel&#39;</span><span class="o">,</span> <span class="s1">&#39;stylesheet&#39;</span><span class="o">);</span>
	<span class="nx">link</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">&#39;type&#39;</span><span class="o">,</span> <span class="s1">&#39;text/css&#39;</span><span class="o">);</span>
	<span class="nx">link</span><span class="o">.</span><span class="nx">setAttribute</span><span class="o">(</span><span class="s1">&#39;href&#39;</span><span class="o">,</span> <span class="nx">src</span><span class="o">);</span>
	<span class="nb">document</span><span class="o">.</span><span class="nx">getElementsByTagName</span><span class="o">(</span><span class="s1">&#39;head&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">].</span><span class="nx">appendChild</span><span class="o">(</span><span class="nx">link</span><span class="o">);</span>
<span class="o">}</span>

<span class="k">function</span> <span class="nx">afterLoad</span><span class="o">(</span><span class="nx">e</span><span class="o">,</span> <span class="nx">async</span><span class="o">)</span>
<span class="o">{</span>	
	<span class="k">if</span><span class="o">(</span><span class="nx">async</span><span class="o">)</span> <span class="nx">_asyncLoaded</span><span class="o">++;</span>
	<span class="k">else</span> <span class="nx">_syncLoaded</span><span class="o">++;</span>
	
	<span class="k">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="nx">async</span> <span class="o">?</span> <span class="nx">_asyncStack</span> <span class="o">:</span> <span class="nx">_syncStack</span><span class="o">;</span>
	<span class="k">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">async</span> <span class="o">?</span> <span class="nx">_asyncLoaded</span> <span class="o">:</span> <span class="nx">_syncLoaded</span><span class="o">;</span>
	<span class="k">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="o">;</span>

	<span class="k">if</span><span class="o">(</span><span class="nx">_syncLoaded</span> <span class="o">===</span> <span class="nx">_syncStack</span><span class="o">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">_asyncLoaded</span> <span class="o">===</span> <span class="nx">_asyncStack</span><span class="o">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">_callback</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="nx">_callback</span><span class="o">.</span><span class="nx">call</span><span class="o">(</span><span class="nx">_callbackCtx</span> <span class="o">||</span> <span class="nx">_callback</span><span class="o">);</span>
	<span class="o">}</span>
	<span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="nx">counter</span> <span class="o">&lt;</span> <span class="nx">stack</span><span class="o">.</span><span class="nx">length</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="nx">stack</span><span class="o">[</span><span class="nx">counter</span><span class="o">];</span>
		<span class="k">var</span> <span class="nx">path</span><span class="o">;</span>
		<span class="k">if</span><span class="o">(</span><span class="k">typeof</span> <span class="nx">mod</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="nx">require</span><span class="o">(</span><span class="nx">mod</span><span class="o">,</span> <span class="nx">async</span><span class="o">);</span>
			<span class="c">// path = _base+mod+&#39;/&#39;+mod;</span>
<span class="c"></span>			<span class="c">// path += _debug ? &#39;.js&#39; : &#39;-min.js&#39;;</span>
<span class="c"></span>			<span class="c">// </span>
<span class="c"></span>			<span class="c">// // Check skins</span>
<span class="c"></span>			<span class="c">// if(_modules[mod].skins)</span>
<span class="c"></span>			<span class="c">// {</span>
<span class="c"></span>			<span class="c">// 	mui.each(_modules[mod].skins, function(skin) {</span>
<span class="c"></span>			<span class="c">// 		var cssPath = _base+mod+&#39;/assets/skins/&#39;+skin+&#39;/&#39;+mod+&#39;.css&#39;</span>
<span class="c"></span>			<span class="c">// 		insertStylesheet(cssPath);</span>
<span class="c"></span>			<span class="c">// 	});</span>
<span class="c"></span>			<span class="c">// }</span>
<span class="c"></span>		<span class="o">}</span>
		<span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="k">typeof</span> <span class="nx">mod</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">mod</span><span class="o">.</span><span class="nx">path</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="nx">path</span> <span class="o">=</span> <span class="nx">mod</span><span class="o">.</span><span class="nx">path</span><span class="o">;</span>
			<span class="nx">insertScript</span><span class="o">(</span><span class="nx">path</span><span class="o">,</span> <span class="nx">mui</span><span class="o">.</span><span class="nx">bind</span><span class="o">(</span><span class="nx">afterLoad</span><span class="o">,</span> <span class="nb">window</span><span class="o">,</span> <span class="nx">args</span><span class="o">[</span><span class="m">1</span><span class="o">]));</span>
		<span class="o">}</span>
	<span class="o">}</span>	
<span class="o">}</span>

<span class="c">/**</span>
<span class="c"> * Require a module</span>
<span class="c"> * @method require</span>
<span class="c"> * @private</span>
<span class="c"> */</span>
<span class="k">function</span> <span class="nx">require</span><span class="o">(</span><span class="nx">module</span><span class="o">,</span> <span class="nx">async</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="nx">_modules</span><span class="o">[</span><span class="nx">module</span><span class="o">];</span>
	<span class="k">var</span> <span class="nx">path</span><span class="o">,</span> <span class="nx">cssPath</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(!</span><span class="nx">mod</span><span class="o">)</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
	
	<span class="k">if</span><span class="o">(</span><span class="nx">_devMode</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">if</span><span class="o">(</span><span class="nx">mod</span><span class="o">.</span><span class="nx">js</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="nx">path</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/js/&#39;</span><span class="o">+</span><span class="nx">mod</span><span class="o">.</span><span class="nx">js</span><span class="o">;</span>
			<span class="nx">insertScript</span><span class="o">(</span><span class="nx">path</span><span class="o">,</span> <span class="nx">mui</span><span class="o">.</span><span class="nx">bind</span><span class="o">(</span><span class="nx">afterLoad</span><span class="o">,</span> <span class="nb">window</span><span class="o">,</span> <span class="nx">async</span><span class="o">));</span>
		<span class="o">}</span>
		<span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="nx">mod</span><span class="o">.</span><span class="nx">submodules</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="nx">mui</span><span class="o">.</span><span class="nx">iterate</span><span class="o">(</span><span class="nx">mod</span><span class="o">.</span><span class="nx">submodules</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">s</span><span class="o">,</span> <span class="nx">n</span><span class="o">)</span> <span class="o">{</span>
				<span class="nx">path</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/js/&#39;</span><span class="o">+</span><span class="nx">s</span><span class="o">.</span><span class="nx">js</span><span class="o">;</span>
				<span class="nx">insertScript</span><span class="o">(</span><span class="nx">path</span><span class="o">,</span> <span class="nx">mui</span><span class="o">.</span><span class="nx">bind</span><span class="o">(</span><span class="nx">afterLoad</span><span class="o">,</span> <span class="nb">window</span><span class="o">,</span> <span class="nx">async</span><span class="o">));</span>
			<span class="o">});</span>
		<span class="o">}</span>

		<span class="k">if</span><span class="o">(</span><span class="nx">mod</span><span class="o">.</span><span class="nx">skins</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">mod</span><span class="o">.</span><span class="nx">skins</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">skin</span><span class="o">)</span> <span class="o">{</span>
				<span class="nx">cssPath</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/assets/skins/&#39;</span><span class="o">+</span><span class="nx">skin</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;-skin.css&#39;</span><span class="o">;</span>
				<span class="nx">insertStylesheet</span><span class="o">(</span><span class="nx">cssPath</span><span class="o">);</span>
			<span class="o">});</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="k">else</span>
	<span class="o">{</span>
		<span class="nx">path</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">module</span><span class="o">;</span>
		<span class="nx">path</span> <span class="o">+=</span> <span class="nx">_debug</span> <span class="o">?</span> <span class="s1">&#39;.js&#39;</span> <span class="o">:</span> <span class="s1">&#39;-min.js&#39;</span><span class="o">;</span>
		
		<span class="nx">insertScript</span><span class="o">(</span><span class="nx">path</span><span class="o">,</span> <span class="nx">mui</span><span class="o">.</span><span class="nx">bind</span><span class="o">(</span><span class="nx">afterLoad</span><span class="o">,</span> <span class="nb">window</span><span class="o">,</span> <span class="nx">async</span><span class="o">));</span>		
	<span class="o">}</span>
<span class="o">}</span>

<span class="c">/**</span>
<span class="c"> * Require core mui</span>
<span class="c"> * @param cb {Function} Callback method</span>
<span class="c"> * @private</span>
<span class="c"> */</span>
<span class="k">function</span> <span class="nx">requireCore</span><span class="o">(</span><span class="nx">cb</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">var</span> <span class="nx">module</span> <span class="o">=</span> <span class="nx">MUI</span><span class="o">;</span>
	<span class="k">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="nx">_modules</span><span class="o">[</span><span class="nx">module</span><span class="o">];</span>
	<span class="k">var</span> <span class="nx">path</span><span class="o">,</span> <span class="nx">cssPath</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="nx">_devMode</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="nx">path</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/js/&#39;</span><span class="o">+</span><span class="nx">mod</span><span class="o">.</span><span class="nx">js</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="k">else</span>
	<span class="o">{</span>
		<span class="nx">path</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">module</span><span class="o">;</span>
		<span class="nx">path</span> <span class="o">+=</span> <span class="nx">_debug</span> <span class="o">?</span> <span class="s1">&#39;.js&#39;</span> <span class="o">:</span> <span class="s1">&#39;-min.js&#39;</span><span class="o">;</span>
		<span class="nx">cssPath</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/assets/reset.css&#39;</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="nx">cssPath</span> <span class="o">=</span> <span class="nx">_base</span><span class="o">+</span><span class="nx">module</span><span class="o">+</span><span class="s1">&#39;/assets/reset.css&#39;</span><span class="o">;</span>

	<span class="nx">insertStylesheet</span><span class="o">(</span><span class="nx">cssPath</span><span class="o">);</span>
	<span class="nx">insertScript</span><span class="o">(</span><span class="nx">path</span><span class="o">,</span> <span class="nx">cb</span><span class="o">);</span>
<span class="o">}</span>

<span class="c">/**</span>
<span class="c"> * Check if a user-defined module is required by another module</span>
<span class="c"> * @method isRequired</span>
<span class="c"> * @param module {Object} The module to check</span>
<span class="c"> * @param extras {Array} Array of extra modules </span>
<span class="c"> * @private</span>
<span class="c"> */</span>
<span class="k">function</span> <span class="nx">isRequired</span><span class="o">(</span><span class="nx">module</span><span class="o">,</span> <span class="nx">extras</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">var</span> <span class="nx">isRequired</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
	<span class="k">for</span><span class="o">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">=</span><span class="m">0</span><span class="o">,</span> <span class="nx">len</span><span class="o">=</span><span class="nx">extras</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">len</span><span class="o">;</span> <span class="nx">i</span><span class="o">++)</span>
	<span class="o">{</span>
		<span class="k">var</span> <span class="nx">requires</span> <span class="o">=</span> <span class="nx">extras</span><span class="o">[</span><span class="nx">i</span><span class="o">].</span><span class="nx">requires</span><span class="o">;</span>
		<span class="k">if</span><span class="o">(</span><span class="nx">requires</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="k">for</span><span class="o">(</span><span class="k">var</span> <span class="nx">j</span><span class="o">=</span><span class="m">0</span><span class="o">,</span> <span class="nx">len2</span><span class="o">=</span><span class="nx">requires</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">len2</span><span class="o">;</span> <span class="nx">j</span><span class="o">++)</span>
			<span class="o">{</span>
				<span class="k">if</span><span class="o">(</span><span class="nx">requires</span><span class="o">[</span><span class="nx">j</span><span class="o">].</span><span class="nx">module</span> <span class="o">===</span> <span class="nx">module</span><span class="o">.</span><span class="nx">module</span><span class="o">)</span>
				<span class="o">{</span>
					<span class="nx">isRequired</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="nx">isRequired</span><span class="o">;</span>
<span class="o">}</span>

<span class="c">/**</span>
<span class="c"> * Load a module or set of modules from mui. Additionally,</span>
<span class="c"> * user-created modules can also be required by proving a path</span>
<span class="c"> * to the script. </span>
<span class="c"> * @method load</span>
<span class="c"> * @param modules {Array} List of mui modules to load</span>
<span class="c"> * @param options {Object} Additional loading options, including extras and callback. See example.</span>
<span class="c"> * Example:</span>
<span class="c"> * 	mui.load([&#39;transition&#39;, &#39;web-app&#39;], {</span>
<span class="c"> * 		base: &#39;../../../build&#39;,</span>
<span class="c"> *		extras: {</span>
<span class="c"> *       		js: [</span>
<span class="c"> *       			{ name: &#39;Base&#39;, path: &#39;Base.js&#39; },</span>
<span class="c"> *       			{ name: &#39;MainModule&#39;, path: &#39;main-module.js&#39;, requires: [ &#39;Base&#39; ] },</span>
<span class="c"> *       			{ name: &#39;SubModule&#39;, path: &#39;submodule.js&#39;, requires: [ &#39;MainModule&#39; ] }</span>
<span class="c"> *       		],</span>
<span class="c"> *       		css: [</span>
<span class="c"> *       			&#39;myCss.css&#39;</span>
<span class="c"> *       		]</span>
<span class="c"> *       	},</span>
<span class="c"> *       	callback: {</span>
<span class="c"> *       		complete: myApp.success,</span>
<span class="c"> *       		scope: myApp</span>
<span class="c"> *       	}</span>
<span class="c"> *	});</span>
<span class="c"> */</span>
<span class="k">function</span> <span class="nx">load</span><span class="o">(</span><span class="nx">modules</span><span class="o">,</span> <span class="nx">options</span><span class="o">)</span>
<span class="o">{</span>	
	<span class="c">// Initialize options</span>
<span class="c"></span>	<span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="o">{};</span>
	<span class="nx">options</span><span class="o">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">options</span><span class="o">.</span><span class="nx">callback</span> <span class="o">||</span> <span class="o">{};</span>

	<span class="nx">_base</span> <span class="o">=</span> <span class="nx">options</span><span class="o">.</span><span class="nx">base</span> <span class="o">||</span> <span class="nx">_base</span><span class="o">;</span>
	<span class="nx">_callback</span> <span class="o">=</span> <span class="nx">options</span><span class="o">.</span><span class="nx">callback</span><span class="o">.</span><span class="nx">complete</span><span class="o">;</span>
	<span class="nx">_callbackCtx</span> <span class="o">=</span> <span class="nx">options</span><span class="o">.</span><span class="nx">callback</span><span class="o">.</span><span class="nx">scope</span><span class="o">;</span>
	<span class="nx">_debug</span> <span class="o">=</span> <span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">debug</span> <span class="o">===</span> <span class="kc">true</span><span class="o">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="o">;</span>
	<span class="nx">_devMode</span> <span class="o">=</span> <span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">developmentMode</span> <span class="o">===</span> <span class="kc">true</span><span class="o">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="o">;</span>
	
	<span class="c">// Require core</span>
<span class="c"></span>	<span class="nx">requireCore</span><span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>

		<span class="c">// Gather sync, async stacks for mui libs</span>
<span class="c"></span>		<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">modules</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">m</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span><span class="o">(!</span><span class="nx">_modules</span><span class="o">[</span><span class="nx">m</span><span class="o">].</span><span class="nx">required</span><span class="o">)</span>
			<span class="o">{</span>
				<span class="nx">_asyncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">m</span><span class="o">);</span>
			<span class="o">}</span>
			<span class="k">else</span>
			<span class="o">{</span>
				<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">_modules</span><span class="o">[</span><span class="nx">m</span><span class="o">].</span><span class="nx">required</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">m2</span><span class="o">)</span> <span class="o">{</span>
					<span class="nx">_syncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">m2</span><span class="o">);</span>
				<span class="o">});</span>
				<span class="nx">_syncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">m</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">});</span>
		
		<span class="c">// Do same for user modules</span>
<span class="c"></span>		<span class="k">if</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="k">if</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">)</span>
			<span class="o">{</span>
				<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">if</span><span class="o">(!</span><span class="nx">e</span><span class="o">.</span><span class="nx">requires</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isRequired</span><span class="o">(</span><span class="nx">e</span><span class="o">,</span> <span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">))</span>
					<span class="o">{</span>
						<span class="nx">_asyncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">e</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="nx">e</span><span class="o">.</span><span class="nx">requires</span><span class="o">)</span>
					<span class="o">{</span>
						<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">e</span><span class="o">.</span><span class="nx">required</span><span class="o">,</span> <span class="k">function</span><span class="o">(</span><span class="nx">e2</span><span class="o">)</span> <span class="o">{</span>
							<span class="k">for</span><span class="o">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">=</span><span class="m">0</span><span class="o">,</span><span class="nx">len</span><span class="o">=</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">len</span><span class="o">;</span> <span class="nx">i</span><span class="o">++)</span>
							<span class="o">{</span>
								<span class="k">if</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">[</span><span class="nx">i</span><span class="o">].</span><span class="nx">module</span> <span class="o">===</span> <span class="nx">e2</span><span class="o">)</span>
								<span class="o">{</span>
									<span class="nx">_syncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">js</span><span class="o">[</span><span class="nx">i</span><span class="o">]);</span>
									<span class="k">break</span><span class="o">;</span>
								<span class="o">}</span>
							<span class="o">}</span>
						<span class="o">});</span>
						<span class="nx">_syncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">e</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="k">else</span>
					<span class="o">{</span>
						<span class="nx">_syncStack</span><span class="o">.</span><span class="nx">push</span><span class="o">(</span><span class="nx">e</span><span class="o">);</span>
					<span class="o">}</span>
				<span class="o">});</span>
			<span class="o">}</span>
			
			<span class="k">if</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">css</span><span class="o">)</span>
			<span class="o">{</span>
				<span class="nx">mui</span><span class="o">.</span><span class="nx">each</span><span class="o">(</span><span class="nx">options</span><span class="o">.</span><span class="nx">extras</span><span class="o">.</span><span class="nx">css</span><span class="o">,</span> <span class="nx">mui</span><span class="o">.</span><span class="nx">bind</span><span class="o">(</span><span class="nx">insertStylesheet</span><span class="o">,</span> <span class="nb">window</span><span class="o">));</span>
			<span class="o">}</span>
		<span class="o">}</span>

		<span class="c">// var mod = _syncStack[0];</span>
<span class="c"></span>		<span class="c">// var path;</span>
<span class="c"></span>		<span class="c">// if(typeof mod === &#39;string&#39;)</span>
<span class="c"></span>		<span class="c">// {</span>
<span class="c"></span>		<span class="c">// 	path = _base+mod+&#39;/&#39;+mod;</span>
<span class="c"></span>		<span class="c">// 	path += _debug ? &#39;.js&#39; : &#39;-min.js&#39;;</span>
<span class="c"></span>		<span class="c">// }</span>
<span class="c"></span>		<span class="c">// else if(typeof mod === &#39;object&#39; &amp;&amp; mod.path)</span>
<span class="c"></span>		<span class="c">// {</span>
<span class="c"></span>		<span class="c">// 	path = mod.path;</span>
<span class="c"></span>		<span class="c">// }</span>
<span class="c"></span>		<span class="c">// </span>
<span class="c"></span>		<span class="c">// insertScript(path, mui.bind(afterLoad, window, false));</span>
<span class="c"></span>		<span class="nx">require</span><span class="o">(</span><span class="nx">_syncStack</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="kc">false</span><span class="o">);</span>
		
		<span class="c">// mod = _asyncStack[0];</span>
<span class="c"></span>		<span class="c">// if(typeof mod === &#39;string&#39;)</span>
<span class="c"></span>		<span class="c">// {</span>
<span class="c"></span>		<span class="c">// 	path = _base+mod+&#39;/&#39;+mod;</span>
<span class="c"></span>		<span class="c">// 	path += _debug ? &#39;.js&#39; : &#39;-min.js&#39;;			</span>
<span class="c"></span>		<span class="c">// }</span>
<span class="c"></span>		<span class="c">// else if(typeof mod === &#39;object&#39; &amp;&amp; mod.path)</span>
<span class="c"></span>		<span class="c">// {</span>
<span class="c"></span>		<span class="c">// 	path = mod.path;</span>
<span class="c"></span>		<span class="c">// }</span>
<span class="c"></span>		<span class="c">// </span>
<span class="c"></span>		<span class="c">// insertScript(path, mui.bind(afterLoad, window, true));</span>
<span class="c"></span>		<span class="nx">require</span><span class="o">(</span><span class="nx">_asyncStack</span><span class="o">[</span><span class="m">0</span><span class="o">],</span> <span class="kc">true</span><span class="o">);</span>

	<span class="o">});</span>
<span class="o">}</span>

<span class="nx">mui</span> <span class="o">=</span> <span class="nb">window</span><span class="o">.</span><span class="nx">mui</span> <span class="o">||</span> <span class="o">{};</span>
<span class="nx">mui</span><span class="o">.</span><span class="nx">load</span> <span class="o">=</span> <span class="nx">load</span><span class="o">;</span>
	
<span class="o">})();</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class=""><a href="module_actionsheet.html" title="actionsheet">actionsheet</a></li>
                                <li class=""><a href="module_ajax.html" title="ajax">ajax</a></li>
                                <li class=""><a href="module_anim.html" title="anim">anim</a></li>
                                <li class=""><a href="module_datasource.html" title="datasource">datasource</a></li>
                                <li class=""><a href="module_dom.html" title="dom">dom</a></li>
                                <li class=""><a href="module_env.html" title="env">env</a></li>
                                <li class=""><a href="module_event.html" title="event">event</a></li>
                                <li class=""><a href="module_framework.html" title="framework">framework</a></li>
                                <li class=""><a href="module_fx.html" title="fx">fx</a></li>
                                <li class=""><a href="module_geo.html" title="geo">geo</a></li>
                                <li class="selected"><a href="module_loader.html" title="loader">loader</a></li>
                                <li class=""><a href="module_navigator.html" title="navigator">navigator</a></li>
                                <li class=""><a href="module_oop.html" title="oop">oop</a></li>
                                <li class=""><a href="module_pager.html" title="pager">pager</a></li>
                                <li class=""><a href="module_scroll-view.html" title="scroll-view">scroll-view</a></li>
                                <li class=""><a href="module_search-box.html" title="search-box">search-box</a></li>
                                <li class=""><a href="module_storage.html" title="storage">storage</a></li>
                                <li class=""><a href="module_swipe-view.html" title="swipe-view">swipe-view</a></li>
                                <li class=""><a href="module_tab-view.html" title="tab-view">tab-view</a></li>
                                <li class=""><a href="module_transition.html" title="transition">transition</a></li>
                                <li class=""><a href="module_util.html" title="util">util</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="Loader.html" title="Loader">Loader</a></li>
                                <li class=""><a href="Loader.html" title="Loader">Loader</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class=""><a href="base.js.html" title="base.js">base.js</a></li>
                                <li class="selected"><a href="Loader.js.html" title="Loader.js">Loader.js</a></li>
                                <li class=""><a href="Loader.old.js.html" title="Loader.old.js">Loader.old.js</a></li>
                                <li class=""><a href="main-module.js.html" title="main-module.js">main-module.js</a></li>
                                <li class=""><a href="submodule.js.html" title="submodule.js">submodule.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
		<div>
        	Copyright &copy; 2009 Yahoo! Inc. All rights reserved.
		</div>
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "Loader.html#method_insertScript", "access": "private", "host": "Loader", "type": "method", "name": "insertScript"}, {"url": "Loader.html#method_insertScript", "access": "private", "host": "Loader", "type": "method", "name": "insertScript"}, {"url": "Loader.html#method_isRequired", "access": "private", "host": "Loader", "type": "method", "name": "isRequired"}, {"url": "Loader.html#method_isRequired", "access": "private", "host": "Loader", "type": "method", "name": "isRequired"}, {"url": "Loader.html#method_load", "access": "", "host": "Loader", "type": "method", "name": "load"}, {"url": "Loader.html#method_load", "access": "", "host": "Loader", "type": "method", "name": "load"}, {"url": "Loader.html#method_require", "access": "private", "host": "Loader", "type": "method", "name": "require"}, {"url": "Loader.html#method_require", "access": "private", "host": "Loader", "type": "method", "name": "require"}, {"url": "Loader.html#method_requireModule", "access": "", "host": "Loader", "type": "method", "name": "requireModule"}, {"url": "Loader.html#method_requireModule", "access": "", "host": "Loader", "type": "method", "name": "requireModule"}];
</script>
</body>
</html>
